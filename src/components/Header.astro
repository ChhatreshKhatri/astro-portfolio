---
import ChhatreshKhatri from "../assets/ChhatreshKhatri.astro";
import NavIcons from "./NavIcons.astro";
import NavLinks from "./NavLinks.astro";
---

<header>
  <nav
    id="navBar"
    class="w-full flex flex-col items-center px-3 py-2 lg:py-1 xs:px-6 md:px-12 lg:px-20 fixed z-10 transition-navBar backdrop-blur-md">
    <div class="flex flex-col justify-center lg:flex-row lg:justify-between w-full">
      <div class="flex justify-between">
        <a aria-label="Home Page" href="/" class="flex justify-center items-center">
          <ChhatreshKhatri />
        </a>

        <button id="menuButton" aria-label="Toggle Menu" class="flex flex-col justify-center items-center lg:hidden">
          <span id="topBar" class="bg-gradient-to-r from-green2 to-blue2 transition-all duration-300 ease-out h-0.5 w-6 rounded-sm -translate-y-1"
          ></span>
          <span
            id="middleBar"
            class="bg-gradient-to-r from-green2 to-blue2 transition-all duration-300 ease-out h-0.5 w-6 rounded-sm my-0.5 opacity-100"></span>
          <span id="bottomBar" class="bg-gradient-to-r from-green2 to-blue2 transition-all duration-300 ease-out h-0.5 w-6 rounded-sm translate-y-1"
          ></span>
        </button>
      </div>
      <div id="navLinks" class="hidden flex-col lg:flex-row items-center justify-center gap-x-8 text-xl font-semibold lg:flex">
        <NavLinks page="Home" link="/" ID="hover1" />
        <NavLinks page="About" link="/about" ID="hover2" />
        <NavLinks page="Projects" link="/projects" ID="hover3" />
      </div>
      <div id="navIcons" class="hidden items-center justify-center whitespace-nowrap gap-x-5 py-1 lg:flex">
        <NavIcons />
      </div>
    </div>
  </nav>
</header>

<script>
  let navOpen = false;
  const topBar = document.getElementById("topBar");
  const middleBar = document.getElementById("middleBar");
  const bottomBar = document.getElementById("bottomBar");
  const navIcons = document.getElementById("navIcons");
  const navBar = document.getElementById("navBar");
  const navLinks = document.getElementById("navLinks");
  function toggleNav() {
    navOpen = !navOpen;
    // Toggle classes on the topBar element
    if (navOpen) {
      topBar?.classList.remove("translate-y-1");
      topBar?.classList.add("rotate-45", "translate-y-1");
      middleBar?.classList.remove("opacity-100");
      middleBar?.classList.add("opacity-0");
      bottomBar?.classList.remove("translate-y-1");
      bottomBar?.classList.add("-rotate-45", "-translate-y-1");

      navLinks?.classList.remove("hidden");
      navLinks?.classList.add("flex");
      navIcons?.classList.remove("hidden");
      navIcons?.classList.add("flex");

      navBar?.classList.add("bg-navbarBg/50", "dark:bg-darker/80");
    }
    if (!navOpen) {
      topBar?.classList.remove("rotate-45", "translate-y-1");
      topBar?.classList.add("-translate-y-1");
      middleBar?.classList.remove("opacity-0");
      middleBar?.classList.add("opacity-100");
      bottomBar?.classList.remove("-rotate-45", "-translate-y-1");
      bottomBar?.classList.add("translate-y-1");

      navLinks?.classList.remove("flex");
      navLinks?.classList.add("hidden");
      navIcons?.classList.remove("flex");
      navIcons?.classList.add("hidden");
      if (window.scrollY == 0) navBar?.classList.remove("bg-navbarBg/50", "dark:bg-darker/80");
    }
  }

  window.addEventListener("scroll", () => {
    if (window.scrollY > 0 || navOpen) {
      navBar?.classList.add("bg-navbarBg/50", "dark:bg-darker/80");
    } else if (window.scrollY == 0 && !navOpen) {
      navBar?.classList.remove("bg-navbarBg/50", "dark:bg-darker/80");
    }
  });

  const menuButton = document.getElementById("menuButton");
  menuButton?.addEventListener("click", toggleNav);

  const currentUrl = window.location.pathname;
  // hover effect on nav links
  const hover1 = document.getElementById("hover1");
  const hover2 = document.getElementById("hover2");
  const hover3 = document.getElementById("hover3");
  if (currentUrl.includes("/about")) {
    hover2?.classList.remove("w-0");
    hover2?.classList.add("w-full");
  } else if (currentUrl.includes("/projects")) {
    hover3?.classList.remove("w-0");
    hover3?.classList.add("w-full");
  } else if (currentUrl.includes("/privacy-policy")) {
    // do nothing
  } else {
    hover1?.classList.remove("w-0");
    hover1?.classList.add("w-full");
  }
</script>
